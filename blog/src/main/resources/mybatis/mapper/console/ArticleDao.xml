<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.sbsm.blog.dao.console.ArticleDao">


    <insert id="insert" parameterType="com.sbsm.blog.entity.console.Article">
        <selectKey resultType="java.lang.Integer" order="AFTER" keyProperty="id">
            SELECT LAST_INSERT_ID()
        </selectKey>
        INSERT INTO `article`(`create_time`, `update_time`, `remark`, `del_flag`, `title`, `descn`,
        `content`, `img_url`, `is_comment`, `is_recommend`, `is_top`, `browse_num`, `comment_num`, `like_num`,
        `is_draft`) VALUES (#{createTime}, #{updateTime}, #{remark}, #{delFlag}, #{title}, #{descn},
        #{content}, #{imgUrl}, #{isComment}, #{isRecommend}, #{isTop}, #{browseNum}, #{commentNum}, #{likeNum},
        #{isDraft})
    </insert>

    <update id="update" parameterType="com.sbsm.blog.entity.console.Article">
        UPDATE `article`
        SET
        `update_time` = #{updateTime},
        `remark` = #{remark},
        `title` = #{title},
        `descn` = #{descn},
        `img_url` = #{imgUrl}
        WHERE
            `id` = #{id}
    </update>

    <update id="updateContent" parameterType="com.sbsm.blog.entity.console.Article">
        UPDATE `article`
        SET
        `update_time` = #{updateTime},
        `content` = #{content}
        WHERE
            `id` = #{id}
    </update>

    <update id="updateIsDraft">
        UPDATE `article`
         SET
         `update_time` = now(),
         `is_draft`=#{arg1}
        WHERE
         `id` = #{arg0}
    </update>

    <update id="delete">
         UPDATE `article`
         SET
         `update_time` = now(),
         `del_flag`=true
        WHERE
         `id` = #{arg0}
    </update>

    <select id="countByIsDraftAndDelFlag" resultType="Integer">
        select count(*) from `article` where `is_draft`=#{arg0} and `del_flag`=#{arg1}
    </select>

    <select id="findDraftList" resultType="com.sbsm.blog.entity.console.Article">
        select *,`create_time` createTime, `update_time` updateTime, `is_draft` isDraft  from `article` where `is_draft`=1 and `del_flag`=0
        order by `update_time` desc
        limit #{arg0}, #{arg1}
    </select>

</mapper>